import { NextRequest, NextResponse } from 'next/server';

// AI Sales Agent System Prompt
const SALES_AGENT_PROMPT = `‡¶§‡ßÅ‡¶Æ‡¶ø "‡¶¨‡ßÅ‡¶¶‡ßç‡¶ß‡¶ø‡¶¶‡ßÄ‡¶™‡ßç‡¶§" - NextGen Digital Studio ‡¶è‡¶∞ AI ‡¶∏‡ßá‡¶≤‡¶∏ ‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü‡•§ ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶è‡¶ï‡¶ú‡¶® ‡¶¨‡ßÅ‡¶¶‡ßç‡¶ß‡¶ø‡¶Æ‡¶æ‡¶®, ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßá‡¶∂‡¶æ‡¶¶‡¶æ‡¶∞ ‡¶∏‡ßá‡¶≤‡¶∏ ‡¶è‡¶ï‡ßç‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶ü‡¶ø‡¶≠‡•§

## üéØ ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø:
1. ‡¶ó‡ßç‡¶∞‡¶æ‡¶π‡¶ï‡ßá‡¶∞ ‡¶ö‡¶æ‡¶π‡¶ø‡¶¶‡¶æ ‡¶ó‡¶≠‡ßÄ‡¶∞‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßÅ‡¶ù‡¶§‡ßá ‡¶π‡¶¨‡ßá
2. ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ü‡¶∏‡ßç‡¶•‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá
3. ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá
4. ‡¶∏‡¶ï‡¶≤ ‡ßÆ‡¶ü‡¶ø ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶∏‡¶Æ‡¶æ‡¶®‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶Æ‡ßã‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá
5. ‡¶ó‡ßç‡¶∞‡¶æ‡¶π‡¶ï‡¶ï‡ßá ‡¶ï‡¶®‡¶≠‡¶ø‡¶®‡ßç‡¶∏ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç WhatsApp ‡¶è ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ü‡¶∏‡¶§‡ßá ‡¶π‡¶¨‡ßá

## üíº NextGen Digital Studio ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá:
- ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶∑‡ßç‡¶†‡¶æ‡¶§‡¶æ: ‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Æ‡ßã‡¶É ‡¶®‡¶æ‡¶ú‡¶Æ‡ßÅ‡¶≤ ‡¶á‡¶∏‡¶≤‡¶æ‡¶Æ ‡¶§‡¶æ‡¶ú (‡¶§‡¶æ‡¶ú ‡¶≠‡¶æ‡¶á)
- **‡¶Ø‡¶∂‡ßã‡¶∞‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞** üèÜ
- ‡ßß‡ß≠+ ‡¶¨‡¶õ‡¶∞‡ßá‡¶∞ ‡¶Ö‡¶≠‡¶ø‡¶ú‡ßç‡¶û‡¶§‡¶æ | ‡ß≠,‡ß´‡ß¶‡ß¶+ ‡¶∏‡¶®‡ßç‡¶§‡ßÅ‡¶∑‡ßç‡¶ü ‡¶ï‡ßç‡¶≤‡¶æ‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü | ‡ß´‡ß¶+ ‡¶¶‡ßá‡¶∂‡ßá ‡¶∏‡ßá‡¶¨‡¶æ

## üé® ‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶ì ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞:

### ü§ñ ‡¶è‡¶Ü‡¶á ‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü (‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ß©‡ß¶,‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá):
- ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ AI ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü‡¶¨‡¶ü - ‡ß®‡ß™/‡ß≠ ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏
- ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü - ‡¶Ö‡¶ü‡ßã‡¶Æ‡ßá‡¶ü‡¶ø‡¶ï ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç
- ‡¶≤‡¶ø‡¶° ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶∂‡¶® - ‡¶™‡¶ü‡ßá‡¶®‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶∞ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡¶æ
- ‡¶≠‡¶Ø‡¶º‡ßá‡¶∏ ‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü - ‡¶´‡ßã‡¶®‡ßá ‡¶Ö‡¶ü‡ßã‡¶Æ‡ßá‡¶ü‡¶ø‡¶ï ‡¶∞‡ßá‡¶∏‡¶™‡¶®‡ßç‡¶∏

### üì± ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ (‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ß´‡ß¶,‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá):
- ‡¶ï‡ßç‡¶∞‡¶∏-‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ - Android ‡¶ì iOS ‡¶¶‡ßÅ‡¶ü‡ßã‡¶§‡ßá‡¶á ‡¶ö‡¶≤‡¶¨‡ßá
- ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ó‡ßá‡¶ü‡¶ì‡¶Ø‡¶º‡ßá - ‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂, ‡¶®‡¶ó‡¶¶, ‡¶∞‡¶ï‡ßá‡¶ü ‡¶á‡¶®‡ßç‡¶ü‡¶ø‡¶ó‡ßç‡¶∞‡ßá‡¶∂‡¶®
- ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ - ‡¶∏‡¶π‡¶ú‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü
- ‡¶™‡ßç‡¶≤‡ßá ‡¶∏‡ßç‡¶ü‡ßã‡¶∞ ‡¶≤‡¶æ‡¶á‡¶≠ - Google Play ‡¶ì App Store ‡¶è ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∂

### üíª ‡¶ì‡¶Ø‡¶º‡ßá‡¶¨‡¶∏‡¶æ‡¶á‡¶ü (‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ßß‡ß´,‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá):
- ‡¶∞‡ßá‡¶∏‡¶™‡¶®‡¶∏‡¶ø‡¶≠ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® - ‡¶∏‡¶¨ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏‡ßá ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞
- SEO ‡¶Ö‡¶™‡¶ü‡¶ø‡¶Æ‡¶æ‡¶á‡¶ú‡¶° - Google ‡¶è ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï‡¶ø‡¶Ç
- ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶Æ‡¶ø‡¶® ‡¶™‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ - ‡¶∏‡¶π‡¶ú‡ßá ‡¶ï‡¶®‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
- ‡ßß ‡¶¨‡¶õ‡¶∞ ‡¶π‡ßã‡¶∏‡ßç‡¶ü‡¶ø‡¶Ç - ‡¶´‡ßç‡¶∞‡¶ø ‡¶π‡ßã‡¶∏‡ßç‡¶ü‡¶ø‡¶Ç ‡¶ì ‡¶°‡ßã‡¶Æ‡ßá‡¶á‡¶®

### üé® ‡ß©‡¶°‡¶ø ‡¶∏‡¶ø‡¶è‡¶®‡¶∏‡¶ø ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® (‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ß®,‡ß¶‡ß¶‡ß¶ - ‡ß®‡ß¶,‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ) üèÜ ‡ßß‡ß¶+ ‡¶¨‡¶õ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶™‡¶æ‡¶∞‡ßç‡¶ü:
- ‡ß©‡¶°‡¶ø ‡¶∞‡¶ø‡¶≤‡¶ø‡¶´ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® - ‡¶ú‡¶ü‡¶ø‡¶≤ ‡¶™‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∞‡ßç‡¶® ‡¶ì ‡¶®‡¶ï‡¶∂‡¶æ
- ‡¶´‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶ö‡¶æ‡¶∞ ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® - ‡¶°‡ßã‡¶∞, ‡¶ñ‡¶æ‡¶ü, ‡¶Ü‡¶≤‡¶Æ‡¶æ‡¶∞‡¶ø
- ‡¶™‡ßã‡¶∞‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶ü ‡¶Ü‡¶∞‡ßç‡¶ü - ‡¶ï‡¶æ‡¶†‡ßá ‡¶ñ‡ßã‡¶¶‡¶æ‡¶á ‡¶ï‡¶∞‡¶æ ‡¶õ‡¶¨‡¶ø
- CNC ‡¶∞‡ßá‡¶°‡¶ø ‡¶´‡¶æ‡¶á‡¶≤ - ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Æ‡ßá‡¶∂‡¶ø‡¶®‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø

### üì± ‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶Æ‡¶ø‡¶°‡¶ø‡¶Ø‡¶º‡¶æ (‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ßÆ,‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ/‡¶Æ‡¶æ‡¶∏ ‡¶•‡ßá‡¶ï‡ßá):
- ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï/‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ - ‡¶™‡ßá‡¶ú ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü
- ‡¶ï‡¶®‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡ßá‡¶∂‡¶® - ‡¶Ü‡¶ï‡¶∞‡ßç‡¶∑‡¶£‡ßÄ‡¶Ø‡¶º ‡¶™‡ßã‡¶∏‡ßç‡¶ü
- ‡¶è‡¶° ‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßá‡¶á‡¶® - ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü‡ßá‡¶° ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°
- ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü - ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø‡¶ï‡ßç‡¶∏

### üé¨ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶è‡¶°‡¶ø‡¶ü‡¶ø‡¶Ç (‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ß©,‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá):
- ‡¶™‡ßç‡¶∞‡ßã‡¶Æ‡ßã ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì - ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶Æ‡ßã‡¶∂‡¶®
- ‡¶∞‡¶ø‡¶≤‡¶∏/‡¶∂‡¶∞‡ßç‡¶ü‡¶∏ - ‡¶≠‡¶æ‡¶á‡¶∞‡¶æ‡¶≤ ‡¶ï‡¶®‡¶ü‡ßá‡¶®‡ßç‡¶ü
- ‡¶Æ‡ßã‡¶∂‡¶® ‡¶ó‡ßç‡¶∞‡¶æ‡¶´‡¶ø‡¶ï‡ßç‡¶∏ - ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶ø‡¶Æ‡ßá‡¶∂‡¶®
- ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ ‡¶ó‡ßç‡¶∞‡ßá‡¶°‡¶ø‡¶Ç - ‡¶∏‡¶ø‡¶®‡ßá‡¶Æ‡¶æ‡¶ü‡¶ø‡¶ï ‡¶≤‡ßÅ‡¶ï

### üé® ‡¶ó‡ßç‡¶∞‡¶æ‡¶´‡¶ø‡¶ï ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® (‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ßß,‡ß´‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶•‡ßá‡¶ï‡ßá):
- ‡¶≤‡ßã‡¶ó‡ßã ‡¶°‡¶ø‡¶ú‡¶æ‡¶á‡¶® - ‡¶á‡¶â‡¶®‡¶ø‡¶ï ‡¶¨‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶° ‡¶Ü‡¶á‡¶°‡ßá‡¶®‡ßç‡¶ü‡¶ø‡¶ü‡¶ø
- ‡¶¨‡¶ø‡¶ú‡¶®‡ßá‡¶∏ ‡¶ï‡¶æ‡¶∞‡ßç‡¶° - ‡¶™‡ßç‡¶∞‡¶´‡ßá‡¶∂‡¶®‡¶æ‡¶≤ ‡¶ï‡¶æ‡¶∞‡ßç‡¶°
- ‡¶∏‡ßã‡¶∂‡ßç‡¶Ø‡¶æ‡¶≤ ‡¶™‡ßã‡¶∏‡ßç‡¶ü - ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï/‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ
- ‡¶¨‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶ø‡¶Ç - ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶¨‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶° ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ú

### üìä ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡¶æ‡¶≤ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡ßá‡¶ü‡¶ø‡¶Ç (‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø: ‡ß´,‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ/‡¶Æ‡¶æ‡¶∏ ‡¶•‡ßá‡¶ï‡ßá):
- SEO ‡¶Ö‡¶™‡¶ü‡¶ø‡¶Æ‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶® - Google ‡¶∞‚Äç‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï‡¶ø‡¶Ç
- ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï‡ßá‡¶ü‡¶ø‡¶Ç - ‡¶®‡¶ø‡¶â‡¶ú‡¶≤‡ßá‡¶ü‡¶æ‡¶∞ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßá‡¶á‡¶®
- ‡¶ï‡¶®‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ü‡ßá‡¶ú‡¶ø - ‡¶ï‡¶®‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞
- ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø‡¶ï‡ßç‡¶∏ - ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶≤‡¶æ‡¶á‡¶∏‡¶ø‡¶∏

## üìû ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó:
- WhatsApp: wa.me/8801711731354
- ‡¶´‡ßã‡¶®: +8801711731354
- ‡¶á‡¶Æ‡ßá‡¶á‡¶≤: concept11art@gmail.com
- ‡¶Ö‡¶´‡¶ø‡¶∏: ‡¶™‡ßÅ‡¶∞‡¶æ‡¶§‡¶® ‡¶ï‡¶∏‡¶¨‡¶æ, ‡¶ò‡ßã‡¶∑‡¶™‡¶æ‡¶°‡¶º‡¶æ, ‡¶Ø‡¶∂‡ßã‡¶∞

## ‚ö†Ô∏è ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£:
- ‡¶∏‡¶¨‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶Ø‡¶º ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡¶æ‡¶ì
- ‡¶á‡¶Æ‡ßã‡¶ú‡¶ø ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßã üé®üí°‚ú®üí∞üìûüèÜ
- ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶§‡¶•‡ßç‡¶Ø‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶∞‡¶æ‡¶ñ‡ßã
- ‡¶∏‡¶ï‡¶≤ ‡ßÆ‡¶ü‡¶ø ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶∏‡¶Æ‡¶æ‡¶®‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶Æ‡ßã‡¶ü ‡¶ï‡¶∞‡ßã
- ‡¶ó‡ßç‡¶∞‡¶æ‡¶π‡¶ï‡¶ï‡ßá ‡¶ï‡¶®‡¶≠‡¶ø‡¶®‡ßç‡¶∏ ‡¶ï‡¶∞‡ßá WhatsApp ‡¶è ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ü‡¶∏‡ßã!`;

// Type definitions
type ChatRole = 'system' | 'user' | 'assistant';

interface ChatMessage {
  role: ChatRole;
  content: string;
}

// Fallback response
const FALLBACK_RESPONSE = `‚ö†Ô∏è ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó‡ßá ‡¶∏‡¶æ‡¶Æ‡¶Ø‡¶º‡¶ø‡¶ï ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§

‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶ø‡¶∏ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá ‡¶ú‡¶æ‡¶®‡¶§‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®:

üìû ‡¶´‡ßã‡¶®: +8801711731354
üì± WhatsApp: wa.me/8801711731354
üìß ‡¶á‡¶Æ‡ßá‡¶á‡¶≤: concept11art@gmail.com

üè¢ **‡¶Ö‡¶´‡¶ø‡¶∏**: ‡¶™‡ßÅ‡¶∞‡¶æ‡¶§‡¶® ‡¶ï‡¶∏‡¶¨‡¶æ, ‡¶ò‡ßã‡¶∑‡¶™‡¶æ‡¶°‡¶º‡¶æ, ‡¶Ø‡¶∂‡ßã‡¶∞
‚è∞ **‡¶∏‡¶Æ‡¶Ø‡¶º**: ‡¶∏‡¶ï‡¶æ‡¶≤ ‡ßß‡ß¶‡¶ü‡¶æ - ‡¶∞‡¶æ‡¶§ ‡ßß‡ß¶‡¶ü‡¶æ

‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶§‡¶æ‡¶ú ‡¶≠‡¶æ‡¶á ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶ï‡¶•‡¶æ ‡¶¨‡¶≤‡¶¨‡ßá‡¶®! üéØ`;

export async function POST(request: NextRequest) {
  try {
    const body = await request.json();
    const { messages, newMessage } = body;

    console.log('üì• Chat Request:', { 
      hasMessages: !!messages, 
      messagesCount: messages?.length || 0,
      hasNewMessage: !!newMessage,
      newMessagePreview: newMessage?.substring(0, 50)
    });

    // Build conversation with proper typing
    const conversationMessages: ChatMessage[] = [
      { role: 'system', content: SALES_AGENT_PROMPT }
    ];

    // Add previous messages (limit to last 8 for context)
    if (messages && Array.isArray(messages)) {
      const recentMessages = messages.slice(-8);
      for (const msg of recentMessages) {
        const role = String(msg.role) as ChatRole;
        if (role === 'user' || role === 'assistant') {
          conversationMessages.push({
            role: role,
            content: String(msg.content)
          });
        }
      }
    }

    // Add new message
    if (newMessage) {
      conversationMessages.push({
        role: 'user',
        content: String(newMessage)
      });
    }

    console.log('üì§ Sending to AI:', { messageCount: conversationMessages.length });

    let response: string | null = null;

    // Try Z-AI SDK first (works locally and on Vercel with internal config)
    try {
      console.log('üîÑ Trying Z-AI SDK...');
      const ZAI = (await import('z-ai-web-dev-sdk')).default;
      const zai = await ZAI.create();
      const completion = await zai.chat.completions.create({
        messages: conversationMessages,
        temperature: 0.8,
        max_tokens: 800,
      });
      response = completion.choices?.[0]?.message?.content;
      if (response) {
        console.log('‚úÖ Z-AI SDK Response received');
      }
    } catch (e) {
      console.log('‚ùå Z-AI SDK error:', e);
    }

    // Try DeepSeek API if Z-AI failed
    if (!response) {
      const deepseekKey = process.env.DEEPSEEK_API_KEY;
      if (deepseekKey) {
        try {
          console.log('üîÑ Trying DeepSeek API...');
          const res = await fetch('https://api.deepseek.com/chat/completions', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${deepseekKey}`
            },
            body: JSON.stringify({
              model: 'deepseek-chat',
              messages: conversationMessages,
              temperature: 0.8,
              max_tokens: 800
            })
          });

          if (res.ok) {
            const data = await res.json();
            response = data.choices?.[0]?.message?.content;
            if (response) {
              console.log('‚úÖ DeepSeek Response received');
            }
          } else {
            const errorData = await res.json().catch(() => ({}));
            console.log('‚ùå DeepSeek failed:', res.status, errorData);
          }
        } catch (e) {
          console.log('‚ùå DeepSeek error:', e);
        }
      }
    }

    // Try OpenRouter API if previous methods failed
    if (!response) {
      const openrouterKey = process.env.OPENROUTER_API_KEY;
      if (openrouterKey) {
        try {
          console.log('üîÑ Trying OpenRouter API...');
          const res = await fetch('https://openrouter.ai/api/v1/chat/completions', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${openrouterKey}`,
              'HTTP-Referer': 'https://nextgen-digital-studio.vercel.app',
              'X-Title': 'NextGen Digital Studio'
            },
            body: JSON.stringify({
              model: 'google/gemini-2.0-flash-exp:free',
              messages: conversationMessages,
              temperature: 0.8,
              max_tokens: 800
            })
          });

          if (res.ok) {
            const data = await res.json();
            response = data.choices?.[0]?.message?.content;
            if (response) {
              console.log('‚úÖ OpenRouter Response received');
            }
          } else {
            const errorData = await res.json().catch(() => ({}));
            console.log('‚ùå OpenRouter failed:', res.status, errorData);
          }
        } catch (e) {
          console.log('‚ùå OpenRouter error:', e);
        }
      }
    }

    // Return response or fallback
    const finalResponse = response || FALLBACK_RESPONSE;
    console.log('üì§ Final response length:', finalResponse.length);

    return NextResponse.json({ message: finalResponse });
    
  } catch (error: unknown) {
    console.error('‚ùå Chat API error:', error);
    
    return NextResponse.json({ 
      message: FALLBACK_RESPONSE,
      error: error instanceof Error ? error.message : 'Unknown error'
    });
  }
}
